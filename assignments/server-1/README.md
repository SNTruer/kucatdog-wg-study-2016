# 1st Assignment

서버

2016.08.02.

## 1. API server

지난 시간에 우리는 게임 서버가 어느 역할을 맡아 사용되는지, 서버에서의 API란 무엇이고 어떻게 동작하는지에 대해 알아봤습니다. 서버 프로그래밍에 한걸음 더 다가가는 방법이자 거의 모든것들을 배우고 익히는데 사실 가장 좋은것은 *직접 해보는 것* 이라고 생각합니다.

여러분이 구현하게 될 것은 따끈따끈한 쿠키를 만들고, 주고받는 베이커리가 될 것입니다. 베이커리 서버를 통해서 여러분들은 각각의 쿠키 정보를 저장하고 주고 받을 수 있는 거죠.

하나의 쿠키는 다음과 같은 JSON 포맷으로 주고 받을 수 있습니다.
```JSON
{
    "flavor": "zombie",
    "size": 10,
}
```
flavor는 'strawberry', 'apple', 'mint', 'peach', 'zombie' 중 하나이고, 크기는 10에서 30 사이의 정수입니다.

베이커리 서버에서의 각각의 쿠키들은 다음과 같은 URL과 메서드를 통해 관리가 됩니다.

| URL          | Method | 기능                                    | 파라미터         | 결과값         |
|--------------|--------|-----------------------------------------|------------------|----------------|
| /cookie/     | GET    | 베이커리에 있는 모든 쿠키를 가져옵니다. |                  | 쿠키 목록      |
| /cookie/     | POST   | 새로운 쿠키를 추가합니다.               | 쿠키 JSON        | 쿠키 ID        |
| /cookie/:id/ | GET    | 해당 쿠키의 정보를 가져옵니다.          |                  | 쿠키 정보      |
| /cookie/:id/ | PUT    | 해당 쿠키의 정보를 수정합니다.          | 수정할 쿠키 JSON | 수정된 쿠키 ID |
| /cookie/:id/ | DELETE | 해당 쿠키를 먹어치워 지웁니다.          |                  | 성공 여부      |

쿠키 ID와 같은 경우는 다음 포맷으로 결과값을 반환하시면 됩니다.
```JSON
{
    "id": 123 //쿠키 ID
}
```


> 잠깐만... HTTP로 통신하고 JSON 포맷으로 쿠키를 주고받는 베이커리라고? 이 얼마나 끔찍하고 무시무시한 상상을 하는거야!

<strike>사실 저도 이거보다 더 예쁜 무언가를 원하지만, 서버는 그런거 없습니다.</strike>

## 2. Testing

프로그래밍의 세계에서 테스트는 매우 중요합니다. 실제로 이 테스트를 하고 오류를 발견하고 그 오류들을 디버깅하는 시간이 프로그램의 기능을 구현하는 시간만큼 오래 걸리기도 하죠. 결국에는 프로그램은 사용자가 원하는 대로 동작해야 하니깐요.

천성으로 귀찮음을 많이 느꼈던 프로그래머들은 *이렇게 귀찮은 테스트 작업을 컴퓨터가 대신 해줬으면 좋겠다* 라는 꿈과 희망을 가지곤 했습니다. 그런 동기가 모이고 모여서 현재의 프로그래밍 커뮤니티에는 테스트 자동화, 그리고 체계화 관련 툴들이 하나둘씩 생기기 시작하였고, 지금은 자동화 툴들을 적절히 이용하면 수많은 양들의 테스트를 단숨에 끝낼 수 있는 수준이 되었죠.

테스트의 체계화 방법론에도 사실 수많은 철학, 기법 그리고 노하우가 존재합니다. 물론 이런 것들을 모두 소개할 수는 없을 것 같지만, 간단히 현재 사용되는 테스트 자동화 프레임워크에 대해 짚고 넘어가도록 하겠습니다.

현재 프로젝트에서는 여러분들이 성공적으로 API 서버를 구현해냈는지 확인할 수 있도록 자동화된 테스트를 이용하여 API 클라이언트를 구현하였습니다. 이 프로젝트에서는 자동화된 테스트를 진행하기 위해 py.test라는 라이브러리를 사용합니다. Python에서 많이 사용되는 라이브러리구요, 테스트 코드는 실제 서버에 요청을 날려서 상황에 따라 원하는 응답이 잘 오는지 판별하는 역할을 하게 됩니다.

## 3. 예외사항

사용자들은 항상 프로그래머가 정해놓은 길로만 행동하지는 않습니다. 항상 엉뚱한 값을 제공하는 사용자들도 있을 뿐더러, 심지어는 그런 것들을 즐기는 <strike>변태</strike>해커들도 있죠. 이런 사용자들에 대한 예외사항의 처리가 필요합니다.

예를 들면,

* 존재하지 않은 쿠키 번호를 가져오거나, 업데이트하거나, 삭제하려고 할 때 '해탕 쿠키가 없음' 이라는 신호를 줘야 합니다. 보통은 HTTP 404 응답 코드를 많이 사용합니다.

* 잘못된 쿠키 데이터를 (예: JSON이 아닌 데이터) 사용하여 업데이트 또는 추가를 요청한 경우, HTTP 400 응답 코드를 사용하여 알려줍니다.

* flavor나 size와 같은 경우에도, 리스트에 있는지? 10에서 30 사이인지? 여부들을 판단하여 추가/업데이트/삭제를 진행할지를 판별하여야 합니다. 잘못된 데이터는 아니지만 데이터가 제약조건에 맞지 않을 경우에는 HTTP 422를 사용합니다.

## 4. 해야할 것

여러분은 이제 정해진 요구사항에 맞는 REST API 서버를 구축하여야 합니다.

먼저, server-1 디렉터리에서
```shell
$ pip install -r requirements.txt
```
명령어로 이 프로젝트에 필요한 flask, flask-restful, requests, pytest 라이브러리를 한번에 설치할 수 있습니다.

그 후에 app/api/cookie.py 파일에 flask-restful 포맷에 맞게 API 서버를 구축할 수 있습니다.

다음으로,
```shell
$ python run.py
$ py.test
```
명령어를 *서로 다른 터미널에서* 각각 실행하면 미리 작성된 자동화된 테스트 코드가 여러분이 만든 베이커리 서버가 제대로 작동하는지 확인을 할 것입니다.

**혹시 테스트 코드가 잘못된 부분이 있다면 바로 알려주시기 바랍니다.**

## 5. 과제 제출 방법

이 Git Repository로 Pull Request를 보내주세요. Pull Request가 뭐냐고요? 구글 신이 알려줄 거에요. 그래도 모르겠다면, 직접 질문을 해주셔도 됩니다.

[참고 링크 1](http://minsone.github.io/git/github-Pull-Request)

[참고 링크 2](https://www.xpressengine.com/devlog/22791272)

[참고 링크 3](http://blog.axisj.com/archives/514)

-----

@nassm__
